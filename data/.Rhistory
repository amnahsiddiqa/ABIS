shiny::runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
sigRNAseq <- read.delim("data/sigmatrixRNAseq.txt", check.names = F)
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
?dataTableOutput
runApp()
runApp()
?req
runApp()
runApp()
library(readxl)
dataset <- read_excel(NULL)
View(dataset)
runApp()
runApp()
library(readr)
TPMPBMC <- read_delim("~/Library/Mobile Documents/com~apple~CloudDocs/Shiny/ABIS-dec/data/TPMPBMC.txt",
"\t", escape_double = FALSE, trim_ws = TRUE)
View(TPMPBMC)
SaveName <- "kal_genes" # assign a value between STAR, kal_tx and kal_genes
source("~/Dropbox/_Deconvolution_paper/src/4.RNAseqObj.R")
source("~/Library/Mobile Documents/com~apple~CloudDocs/Work_temp/Source_code/deconvolution/LLS.R")
source("~/Library/Mobile Documents/com~apple~CloudDocs/Work_temp/Source_code/deconvolution/CIBERSORT.R")
# load the libraries
libraries <- "dplyr,reshape2,edgeR,ggplot2,RColorBrewer,e1071,preprocessCore,epiR,MASS"
libraries <- strsplit(libraries, ",")[[1]]
for (name in libraries) {
suppressPackageStartupMessages(library(name, character.only=T, warn.conflicts=F, quietly=T, verbose=F))
}
load("tpm/DiffData.RData")
load("../pheno/Groups_Flow.RData")
# select and create folders
namenorm <- dir(pattern="tpm")[1]
SaveDir <- "deconOpt"
dir.create(SaveDir, showWarnings = FALSE)
SIGMAT <- meanGE
FILTER_SIGMAT <- F
########### START from here ############
# GRc <-  c("T CD4 Naive","T CD8 Naive","T CD8 Memory", "T CD4 Memory", "MAIT", "T gd Vd2", "T gd non-Vd2" ,  "Progenitors",  "B Naive", "B Memory", "Plasmablasts", "Monocytes NC" ,"Monocytes I", "Monocytes C" , "NK",  "mDCs","pDCs","Neutrophils LD" , "Basophils LD")
#GRc <-  c("T CD4 Naive","T CD8 Naive","T CD8 Memory", "T CD4 Memory", "MAIT", "T gd Vd2", "T gd non-Vd2" , "Progenitors", "B Naive", "B Memory", "Plasmablasts", "Monocytes NC" ,"Monocytes C+I" , "NK",  "mDCs","pDCs","Neutrophils LD" , "Basophils LD")
GRc <-  c("T CD4 Naive","T CD8 Naive","T CD8 Memory", "T CD4 Memory", "MAIT", "T gd Vd2", "T gd non-Vd2" ,  "Progenitors",  "B Naive", "B Memory", "Plasmablasts", "Monocytes NC+I" ,"Monocytes C" , "NK",  "mDCs","pDCs","Neutrophils LD" , "Basophils LD")
pheno$group <- as.character(pheno$group)
for(i in 1:length(GR1sort)){
names(GR1sort)[i] <- GRc[GRc %in% pheno[which(pheno$group == GR1sort[i])[1],]]
}
GRc <- unique(names(GR1sort))
#GRc<- GRc[!is.na(GRc)]
flowtemp <- flowper[colnames(TPMPBMC), GRc]
SIGMAT0 <- SIGMAT[, GRc]
View(TPMPBMC)
setwd("~/Library/Mobile Documents/com~apple~CloudDocs/Shiny/ABIS-dec/data")
mix <- read.delim("TPMPBMC.txt")
View(meanGE)
View(mix)
mix <- read.delim("TPMPBMC.txt",sep=" ")
View(TPMPBMC)
SaveName <- "kal_genes" # assign a value between STAR, kal_tx and kal_genes
source("~/Dropbox/_Deconvolution_paper/src/4.RNAseqObj.R")
source("~/Library/Mobile Documents/com~apple~CloudDocs/Work_temp/Source_code/deconvolution/LLS.R")
source("~/Library/Mobile Documents/com~apple~CloudDocs/Work_temp/Source_code/deconvolution/CIBERSORT.R")
# load the libraries
libraries <- "dplyr,reshape2,edgeR,ggplot2,RColorBrewer,e1071,preprocessCore,epiR,MASS"
libraries <- strsplit(libraries, ",")[[1]]
for (name in libraries) {
suppressPackageStartupMessages(library(name, character.only=T, warn.conflicts=F, quietly=T, verbose=F))
}
load("tpm/DiffData.RData")
load("../pheno/Groups_Flow.RData")
# select and create folders
namenorm <- dir(pattern="tpm")[1]
SaveDir <- "deconOpt"
dir.create(SaveDir, showWarnings = FALSE)
SIGMAT <- meanGE
FILTER_SIGMAT <- F
########### START from here ############
# GRc <-  c("T CD4 Naive","T CD8 Naive","T CD8 Memory", "T CD4 Memory", "MAIT", "T gd Vd2", "T gd non-Vd2" ,  "Progenitors",  "B Naive", "B Memory", "Plasmablasts", "Monocytes NC" ,"Monocytes I", "Monocytes C" , "NK",  "mDCs","pDCs","Neutrophils LD" , "Basophils LD")
#GRc <-  c("T CD4 Naive","T CD8 Naive","T CD8 Memory", "T CD4 Memory", "MAIT", "T gd Vd2", "T gd non-Vd2" , "Progenitors", "B Naive", "B Memory", "Plasmablasts", "Monocytes NC" ,"Monocytes C+I" , "NK",  "mDCs","pDCs","Neutrophils LD" , "Basophils LD")
GRc <-  c("T CD4 Naive","T CD8 Naive","T CD8 Memory", "T CD4 Memory", "MAIT", "T gd Vd2", "T gd non-Vd2" ,  "Progenitors",  "B Naive", "B Memory", "Plasmablasts", "Monocytes NC+I" ,"Monocytes C" , "NK",  "mDCs","pDCs","Neutrophils LD" , "Basophils LD")
pheno$group <- as.character(pheno$group)
for(i in 1:length(GR1sort)){
names(GR1sort)[i] <- GRc[GRc %in% pheno[which(pheno$group == GR1sort[i])[1],]]
}
GRc <- unique(names(GR1sort))
#GRc<- GRc[!is.na(GRc)]
flowtemp <- flowper[colnames(TPMPBMC), GRc]
SIGMAT0 <- SIGMAT[, GRc]
setwd("~/Library/Mobile Documents/com~apple~CloudDocs/Shiny/ABIS-dec/data")
write.table(x = TPMPBMC, "TPMP.txt", sep = "/t")
write.table(x = TPMPBMC, "TPMP.txt", sep = "\t")
runApp('~/Library/Mobile Documents/com~apple~CloudDocs/Shiny/ABIS-dec')
runApp('~/Library/Mobile Documents/com~apple~CloudDocs/Shiny/ABIS-dec')
?signif
runApp('~/Library/Mobile Documents/com~apple~CloudDocs/Shiny/ABIS-dec')
genes <- intersect(rownames(TPMPBMC), rownames(sigRNAseq))
genes
Dec <- (apply(TPMPBMC[genes,], 2, function(x) coef(rlm( as.matrix(sigRNAseq[genes,]), x )))) *100
Dec
?dataTableOutput
